2025-04-29 10:01:06,795 - classification_service - INFO - Job 107 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:01:06,820 - classification_service - INFO - Job 107 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:658]
2025-04-29 10:01:38,862 - classification_service - INFO - Job 108 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:01:39,821 - classification_service - INFO - Job 108 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:658]
2025-04-29 10:05:10,643 - classification_service - INFO - Job 109 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:05:10,923 - classification_service - INFO - Job 109 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:658]
2025-04-29 10:05:20,306 - classification_service - INFO - Job 110 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:05:20,572 - classification_service - INFO - Job 110 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:658]
2025-04-29 10:05:27,567 - classification_service - INFO - Job 111 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:05:27,757 - classification_service - INFO - Job 111 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:658]
2025-04-29 10:06:27,087 - classification_service - INFO - Job 112 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:06:28,281 - classification_service - ERROR - Invalid status transition for Job 112: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED - [classification.py:662]
2025-04-29 10:06:28,290 - classification_service - INFO - Job 112 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:658]
2025-04-29 10:07:28,302 - classification_service - INFO - Job 112 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:07:28,316 - classification_service - INFO - Job 112 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:658]
2025-04-29 10:09:44,443 - classification_service - INFO - Job 113 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:09:45,286 - classification_service - ERROR - Invalid status transition for Job 113: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED - [classification.py:662]
2025-04-29 10:09:45,298 - classification_service - INFO - Job 113 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:658]
2025-04-29 10:09:58,874 - classification_service - INFO - Job 114 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:09:59,403 - classification_service - ERROR - Invalid status transition for Job 114: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED - [classification.py:662]
2025-04-29 10:09:59,411 - classification_service - INFO - Job 114 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:658]
2025-04-29 10:10:15,231 - classification_service - INFO - Job 115 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:10:15,759 - classification_service - ERROR - Invalid status transition for Job 115: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED - [classification.py:662]
2025-04-29 10:10:15,766 - classification_service - INFO - Job 115 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:658]
2025-04-29 10:10:23,067 - classification_service - INFO - Job 116 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:10:23,576 - classification_service - ERROR - Invalid status transition for Job 116: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED - [classification.py:662]
2025-04-29 10:10:23,583 - classification_service - INFO - Job 116 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:658]
2025-04-29 10:10:45,309 - classification_service - INFO - Job 113 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:10:45,321 - classification_service - INFO - Job 113 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:658]
2025-04-29 10:11:23,592 - classification_service - INFO - Job 116 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:11:23,606 - classification_service - INFO - Job 116 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:658]
2025-04-29 10:16:46,584 - classification_service - INFO - Job 117 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:16:47,358 - classification_service - ERROR - Invalid status transition for Job 117: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED - [classification.py:662]
2025-04-29 10:16:47,366 - classification_service - INFO - Job 117 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:658]
2025-04-29 10:17:47,378 - classification_service - INFO - Job 117 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:17:47,393 - classification_service - INFO - Job 117 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:658]
2025-04-29 10:29:59,710 - classification_service - INFO - Job 118 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:30:00,708 - classification_service - INFO - Job 118 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:658]
2025-04-29 10:33:15,086 - classification_service - INFO - Job 119 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:658]
2025-04-29 10:33:16,055 - classification_service - ERROR - Invalid status transition for Job 119: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED - [classification.py:662]
2025-04-29 10:33:16,062 - classification_service - INFO - Job 119 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:658]
2025-04-29 10:34:20,710 - classification_service - INFO - Job 119 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:670]
2025-04-29 10:34:20,734 - classification_service - INFO - Job 119 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:670]
2025-04-29 10:35:23,894 - classification_service - INFO - Job 120 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:670]
2025-04-29 10:35:23,917 - classification_service - ERROR - Classification failed for scheme 12: OpolClassificationProvider.classify() got an unexpected keyword argument 'model_class' - [classification.py:557]
Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 550, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OpolClassificationProvider.classify() got an unexpected keyword argument 'model_class'
2025-04-29 10:35:23,923 - classification_service - INFO - Job 120 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:670]
2025-04-29 11:15:58,904 - classification_service - INFO - Job 152 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:664]
2025-04-29 11:15:58,927 - classification_service - ERROR - Classification failed for scheme 12 in service: OpolClassificationProvider.classify() got an unexpected keyword argument 'api_key' - [classification.py:552]
Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 545, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OpolClassificationProvider.classify() got an unexpected keyword argument 'api_key'
2025-04-29 11:15:58,933 - classification_service - INFO - Job 152 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:664]
2025-04-29 11:38:11,846 - classification_service - INFO - Job 153 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:664]
2025-04-29 11:38:11,856 - classification_service - ERROR - Classification failed for scheme 12 in service: OpolClassificationProvider.classify() got an unexpected keyword argument 'api_key' - [classification.py:552]
Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 545, in classify_text
    # Explicitly log if fields are missing after eager loading attempt
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OpolClassificationProvider.classify() got an unexpected keyword argument 'api_key'
2025-04-29 11:38:11,860 - classification_service - INFO - Job 153 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:664]
2025-04-29 11:38:32,420 - classification_service - INFO - Job 154 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:664]
2025-04-29 11:38:32,428 - classification_service - ERROR - Classification failed for scheme 12 in service: OpolClassificationProvider.classify() got an unexpected keyword argument 'api_key' - [classification.py:552]
Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 545, in classify_text
    # Explicitly log if fields are missing after eager loading attempt
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OpolClassificationProvider.classify() got an unexpected keyword argument 'api_key'
2025-04-29 11:38:32,432 - classification_service - INFO - Job 154 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:664]
2025-04-29 11:39:21,434 - classification_service - INFO - Job 155 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:678]
2025-04-29 11:39:22,298 - classification_service - INFO - Job 155 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:678]
2025-04-29 12:03:31,607 - classification_service - INFO - Job 156 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:678]
2025-04-29 12:03:31,898 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625481fd490 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:32,094 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482ae3d0 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:32,276 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482aca90 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:32,465 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x76254932b490 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:32,637 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482ba090 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:32,806 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x762548271a10 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:32,961 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482d1710 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:33,120 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482d06d0 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:33,292 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482c8a10 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:33,427 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482d1490 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:33,434 - classification_service - INFO - Job 156 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:678]
2025-04-29 12:03:53,260 - classification_service - INFO - Job 157 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:678]
2025-04-29 12:03:53,426 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482f39d0 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:53,633 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482f0810 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:53,797 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482f2c10 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:53,998 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482f1710 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:54,129 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x76254810bf50 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:54,252 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482f1910 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:54,386 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482f2b90 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:54,532 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x762548101c10 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:54,673 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x762548108610 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:54,801 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625492fc1d0 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:03:54,807 - classification_service - INFO - Job 157 status updated to ClassificationJobStatus.COMPLETED_WITH_ERRORS in session. - [classification.py:678]
2025-04-29 12:06:49,911 - classification_service - INFO - Job 158 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:678]
2025-04-29 12:06:52,234 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x76254932ac10 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:06:52,426 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482b8e50 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:06:52,574 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482b8410 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:06:52,723 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x7625482af3d0 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:06:52,856 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x762548117910 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:06:52,993 - classification_service - ERROR - Classification failed for scheme 9 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x762548113bd0 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:06:53,142 - classification_service - ERROR - Classification failed for scheme 12 in service: Classification failed: 429 Resource has been exhausted (e.g. check quota). - [classification.py:566]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 168, in retry_sync
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/generativeai/generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 835, in generate_content
    response = rpc(
               ^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.11/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 Resource has been exhausted (e.g. check quota).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 163, in retry_sync
    for attempt in max_retries:
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 421, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x762548126a10 state=finished raised ResourceExhausted>]

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/services/providers/classification.py", line 85, in classify
    result = fastclass.classify(model_class, instructions, text)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/classification.py", line 35, in classify
    return self.fastclass.infer(response_type, input_text, prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/opol/api/fastclass.py", line 93, in infer
    llm_response = self.client.messages.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/client.py", line 180, in create
    return self.create_fn(
           ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/patch.py", line 193, in new_create_sync
    response = retry_sync(
               ^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/instructor/retry.py", line 194, in retry_sync
    raise InstructorRetryException(
instructor.exceptions.InstructorRetryException: 429 Resource has been exhausted (e.g. check quota).

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/api/services/classification.py", line 559, in classify_text
    return self.provider.classify(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/api/services/providers/classification.py", line 100, in classify
    raise RuntimeError(f"Classification failed: {str(e)}")
RuntimeError: Classification failed: 429 Resource has been exhausted (e.g. check quota).
2025-04-29 12:06:53,163 - classification_service - ERROR - Invalid status transition for Job 158: Cannot transition from ClassificationJobStatus.PENDING to ClassificationJobStatus.COMPLETED_WITH_ERRORS - [classification.py:682]
2025-04-29 12:06:53,169 - classification_service - INFO - Job 158 status updated to ClassificationJobStatus.FAILED in session. - [classification.py:678]
2025-04-29 12:07:53,179 - classification_service - INFO - Job 158 status updated to ClassificationJobStatus.RUNNING in session. - [classification.py:678]
2025-04-29 12:07:58,455 - classification_service - INFO - Job 158 status updated to ClassificationJobStatus.COMPLETED in session. - [classification.py:678]
